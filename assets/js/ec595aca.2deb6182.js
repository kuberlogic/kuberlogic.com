"use strict";(self.webpackChunkkuberlogic_com=self.webpackChunkkuberlogic_com||[]).push([[3309],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>m});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=i.createContext({}),p=function(e){var t=i.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},s=function(e){var t=p(e.components);return i.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},g=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,c=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),g=p(n),m=r,d=g["".concat(c,".").concat(m)]||g[m]||u[m]||a;return n?i.createElement(d,o(o({ref:t},s),{},{components:n})):i.createElement(d,o({ref:t},s))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=g;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var p=2;p<a;p++)o[p]=n[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}g.displayName="MDXCreateElement"},175:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var i=n(7462),r=(n(7294),n(3905));const a={id:"billing",title:"Integrating with billing provider",tags:["Billing provider","configuration"]},o=void 0,l={unversionedId:"configuring/billing",id:"configuring/billing",title:"Integrating with billing provider",description:"KuberLogic uses webhooks to integrate with various billing providers. Below you can find a scheme of core moving parts of a billing provider integration and instructions on how to set up ChargeBee to work with KuberLogic.",source:"@site/docs/configuring/billing.md",sourceDirName:"configuring",slug:"/configuring/billing",permalink:"/docs/configuring/billing",draft:!1,editUrl:"https://github.com/kuberlogic/docs.kuberlogic.com/docs/configuring/billing.md",tags:[{label:"Billing provider",permalink:"/docs/tags/billing-provider"},{label:"configuration",permalink:"/docs/tags/configuration"}],version:"current",frontMatter:{id:"billing",title:"Integrating with billing provider",tags:["Billing provider","configuration"]},sidebar:"mySidebar",previous:{title:"Preparing your application",permalink:"/docs/configuring/docker-compose"},next:{title:"Application management with CLI",permalink:"/docs/using/cli_app"}},c={},p=[{value:"Configuring KuberLogic",id:"configuring-kuberlogic",level:3}],s={toc:p};function u(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,i.Z)({},s,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"KuberLogic uses webhooks to integrate with various billing providers. Below you can find a scheme of core moving parts of a billing provider integration and instructions on how to set up ChargeBee to work with KuberLogic.\nBilling providers such as ChargeBee have ready-made components that you can easily integrate into your own site (create a pricing table, add products, set up a customer portal)."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(3492).Z,width:"5121",height:"3124"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Step 1. Software vendors post a pricing table on a product site (",(0,r.kt)("a",{parentName:"p",href:"https://www.chargebee.com/checkout-portal-docs/drop-in-integration.html#integrating-checkout"},"Products and checkout"),"). Users can choose a product from the pricing table and proceed to checkout. Also you need to add ",(0,r.kt)("a",{parentName:"p",href:"https://www.chargebee.com/docs/2.0/custom_fields.html"},"custom field"),' "domain" (as in example below) that will be updated by KuberLogic once application instance is ready.\n',(0,r.kt)("img",{src:n(1856).Z,width:"1280",height:"204"}))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Step 2. The billing provider charges the user in accordance with the chosen subscription plan.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Step 3. The billing provider sends an event via Webhook to KuberLogic. 1. ",(0,r.kt)("a",{parentName:"p",href:"https://www.chargebee.com/docs/2.0/api_keys.html"},"API keys")," 2. ",(0,r.kt)("a",{parentName:"p",href:"https://www.chargebee.com/docs/2.0/events_and_webhooks.html"},"Webhook"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Step 4. KuberLogic generates a domain name for the application instance, provisions an application instance in accordance with the chosen subscription plan, and ensures application availability.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Step 5-6. After the application instance is provisioned KuberLogic sends an event to the Billing provider with the application instance domain name information. This event updates the user's subscription with the domain.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},'Step 7. On the "subscription update," event Billing provider sends an e-mail "Your subscription has been updated" to the User with the application domain name added to the e-mail custom field. You can customize the e-mail template to something like "Your application instance is provisioned!" and add to the template previously created custom field. ',(0,r.kt)("a",{parentName:"p",href:"https://www.chargebee.com/docs/2.0/email-notifications-v2.html"},"Email Notifications"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Additional. You should add a link to the Customers portal to your application to allow users to manage the subscription ",(0,r.kt)("a",{parentName:"p",href:"https://www.chargebee.com/docs/1.0/customer_portal.html"},"Single Page Customer Portal")))),(0,r.kt)("h3",{id:"configuring-kuberlogic"},"Configuring KuberLogic"),(0,r.kt)("p",null,"You will be asked to configure Chargebee integration during the installation process. Leaving ",(0,r.kt)("inlineCode",{parentName:"p"},"Chargebee site")," parameter empty will disable Chargebee integration."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'"KuberLogic domain" configuration parameter is used by KuberLogic to generate subdomains for the application instances (e.g. ',(0,r.kt)("a",{parentName:"li",href:"http://magnetic-llama.example.com"},"http://magnetic-llama.example.com"),",  ",(0,r.kt)("a",{parentName:"li",href:"http://pleasant-antelope.example.com"},"http://pleasant-antelope.example.com"),")")),(0,r.kt)("p",null,"Example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"  - chargebee_site=example-test\n  - chargebee_key=test_aTwdMcu4LDMU3eCadmXCJYcubL60tGDYbGeUg\n  - kuberlogic_domain=example.com\n")),(0,r.kt)("p",null,"Webhook configuration example:"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(8367).Z,width:"1280",height:"1077"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},'Webhook URL should lead to "kls-chargebee-integration" service External IP.')),(0,r.kt)("p",null,"Type to see the IP:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},">kubectl get svc -n kuberlogic\n# Example output\n#NAME                                     TYPE           CLUSTER-IP   EXTERNAL-IP      PORT(S)        AGE\n#kls-api-server                           LoadBalancer   10.8.10.73   34.121.153.159   80:31098/TCP   5h19m\n#kls-chargebee-integration                LoadBalancer   10.8.10.7    34.135.30.100    80:32415/TCP   5h19m\n#kls-controller-manager-metrics-service   ClusterIP      10.8.4.214   <none>           8443/TCP       5h19m\n#kls-webhook-service                      ClusterIP      10.8.15.55   <none>           443/TCP        5h19m\n")))}u.isMDXComponent=!0},8367:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/Webhook_example-00a84396ad207597ae6931774b016ddf.png"},3492:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/billing_integration-16dde5fc48e304f7aefc66ad645e6678.png"},1856:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/chargebee_custom_field-3553f1759dde2f05be83e9c9e965d5fd.png"}}]);